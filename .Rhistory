C.D1000$rep1$model$SpeciesMeta$rawLII
C.D1000$rep1$model$SpeciesMeta$rawLII==0
names(C.D1000$rep1$model$SpeciesMeta$rawLII)
rownames(C.D1000$rep1$model$SpeciesMeta$rawLII)
C.D1000$rep1$model$SpeciesMeta$rawLII
C.D1000$rep1$model$SpeciesMeta
row.names(C.D1000$rep1$model$SpeciesMeta$rawLII)
row.names(C.D1000$rep1$model$SpeciesMeta$rawLII)
row.names(C.D1000$rep1$model$SpeciesMeta)
keep<-row.names(C.D1000$rep1$model$SpeciesMeta)[C.D1000$rep1$model$SpeciesMeta$rawLII==0]
keep
om<-prune_taxa(taxa_names(C.D1000$rep1$model$comm)%in%keep,C.D1000$rep1$model$comm)
plot_bar(om)
plot_bar(om, color=taxa_names)
?plot_bar
plot_bar(om, fill=taxa_names)
plot_bar(om)
sample_sums(om)
estimate_richness(om, measures="Observed")
?barplot
taxa_names(C.D1000$rep1$model$comm)
tax_table(C.D1000$rep1$model$comm)
tax_table(C.D1000$rep1$model$comm)<-taxa_names(C.D1000$rep1$model$comm)
tax_table(C.D1000$rep1$model$comm)
estimate_richness(om, measures="Observed")
table(estimate_richness(om, measures="Observed")>0)
length(keep)
table(estimate_richness(om, measures="Observed")==1)
taxa_names(C.D1000$rep1$model$comm)
tax_table(C.D1000$rep1$model$comm)<-taxa_names(C.D1000$rep1$model$comm)
tax_table(C.D1000$rep1$model$comm)
t<-data.frame("names"=taxa_names(C.D1000$rep1$model$comm), "names2"=taxa_names(C.D1000$rep1$model$comm), "names3"=taxa_names(C.D1000$rep1$model$comm))
tax_table(C.D1000$rep1$model$comm)<-t
rownames(t)<-taxa_names(C.D1000$rep1$model$comm)
tax_table(C.D1000$rep1$model$comm)<-t
t<-tax_table(t)
tax_table(C.D1000$rep1$model$comm)<-t
taxa_names(t)
taxa_names(C.D1000$rep1$model$comm)
taxa_names(t)<-taxa_names(C.D1000$rep1$model$comm)
tax_table(C.D1000$rep1$model$comm)<-t
keep<-row.names(C.D1000$rep1$model$SpeciesMeta)[C.D1000$rep1$model$SpeciesMeta$rawLII==0]
om<-prune_taxa(taxa_names(C.D1000$rep1$model$comm)%in%keep, C.D1000$rep1$model$comm)
plot_bar(om, fill="names")
keep<-row.names(C.D1000$rep1$model$SpeciesMeta)[C.D1000$rep1$model$SpeciesMeta$rawLII==0]
om<-prune_taxa(taxa_names(C.D1000$rep1$model$comm)%in%keep, C.D1000$rep1$model$comm)
tax_table(om)
plot_bar(om, fill="ta1")
sample_sums(om)
plot_bar(om, fill="ta1")
sample_sums(om)
estimate_richness(om, measures="Observed")
estimate_richness(om, measures="Observed")+theme_classic()+scale_color_viridis_d()
plot_bar(om, fill="ta1")+theme_classic()+scale_color_viridis_d()
plot_bar(om, fill="ta1")+scale_color_viridis_d()
ggplot(C.D1000$rep1model$SpeciesMeta, aes(x=log10(M.Eval),y=log(rawLII),col=rawDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(rawLII),col=rawDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(RALII),col=RADMI))+
geom_point()+
scale_color_viridis_c(option="C")+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(deseqLII),col=deseqDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-5, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(rawLII),col=rawDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-4, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(RALII),col=RADMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-4, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-4, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(deseqLII),col=deseqDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-4, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-4, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-5, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-6, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(rawLII),col=rawDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(RALII),col=RADMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(deseqLII),col=deseqDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(rawLII),col=rawDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log raw LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(RALII),col=RADMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log relative abundance LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Logs caled LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(deseqLII),col=deseqDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log deseq LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log limma LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta[C.D1000$rep1$model$SpeciesMeta$deseqLII==0], aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log limma LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta[C.D1000$rep1$model$SpeciesMeta$deseqLII==0,], aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log limma LII value", limits=c(-8, 0))+
theme_classic()
tax_table(C.D1000$rep1$limma$comm)<-t
om2<-prune_taxa(taxa_names(C.D1000$rep1$limma$comm)%in%keep, C.D1000$rep1$limma$comm)
tax_table(C.D1000$rep1$limma$comm)<-t
om2<-prune_taxa(taxa_names(C.D1000$rep1$limma$comm)%in%keep, C.D1000$rep1$limma$comm)
plot_bar(om, fill="ta1")
plot_bar(om2, fill="ta1")
tax_table(C.D1000$rep1$model$comm)<-t
tax_table(C.D1000$rep1$limma$comm)<-t
tax_table(C.D1000$rep1$deseqVST$comm)<-t
tax_table(C.D1000$rep1$scaled$comm)<-t
reference_r<-prune_taxa(taxa_names(C.D1000$rep1$model$comm)%in%keep, C.D1000$rep1$model$comm)
limma_r<-prune_taxa(taxa_names(C.D1000$rep1$limma$comm)%in%keep, C.D1000$rep1$limma$comm)
deseq_r<-prune_taxa(taxa_names(C.D1000$rep1$deseqVST$comm)%in%keep, C.D1000$rep1$deseqVST$comm)
scaled_r<-prune_taxa(taxa_names(C.D1000$rep1$scaled$comm)%in%keep, C.D1000$rep1$scaled$comm)
plot_bar(reference_r, fill="ta1")
plot_bar(limma_r, fill="ta1")
plot_bar(deseq_r, fill="ta1")
plot_bar(scaled_r, fill="ta1")
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(rawLII),col=rawDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log raw LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(RALII),col=RADMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log relative abundance LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Logs caled LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(deseqLII),col=deseqDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log deseq LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log limma LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta[C.D1000$rep1$model$SpeciesMeta$deseqLII==0,], aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log limma LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(rawLII),col=rawDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log raw LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(RALII),col=RADMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log relative abundance LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(scaledLII),col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Logs scaled LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(deseqLII),col=deseqDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log deseq LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta, aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log limma LII value", limits=c(-8, 0))+
theme_classic()
ggplot(C.D1000$rep1$model$SpeciesMeta[C.D1000$rep1$model$SpeciesMeta$deseqLII==0,], aes(x=log10(M.Eval),y=log(limmaLII),col=limmaDMI))+
geom_point()+
scale_color_viridis_c(option="C")+
scale_x_continuous(name="Log E value", limits=c(-4, 0)) +
scale_y_continuous(name="Log limma LII value", limits=c(-8, 0))+
theme_classic()
# benchmark with total = 75; different sequencing depth
P_C.D500<-ext.PERMANOVA(C.D500)
P_C.D1000<-ext.PERMANOVA(C.D1000)
P_C.D2000<-ext.PERMANOVA(C.D2000)
P_C.D10000<-ext.PERMANOVA(C.D10000)
# seq depth at mostly universal taxa
# benchmark with total = 75; different sequencing depth
P_G.D500<-ext.PERMANOVA(G.D500)
P_G.D1000<-ext.PERMANOVA(G.D1000)
P_G.D2000<-ext.PERMANOVA(G.D2000)
P_G.D10000<-ext.PERMANOVA(G.D10000)
# seq depth at mostly universal taxa
# benchmark with total = 75; different sequencing depth
P_S.D500<-ext.PERMANOVA(S.D500)
P_S.D2000<-ext.PERMANOVA(S.D2000)
P_S.D10000<-ext.PERMANOVA(S.D10000)
# seq depth at mostly universal taxa
# benchmark with total = 75; different sequencing depth
P_E.D500<-ext.PERMANOVA(E.D500)
P_E.D2000<-ext.PERMANOVA(E.D2000)
P_V.D500<-ext.PERMANOVA(V.D500)
P_V.D1000<-ext.PERMANOVA(V.D1000)
P_V.D2000<-ext.PERMANOVA(V.D2000)
P_C.D500$Level<-c(rep(500, 10))
P_C.D1000$Level<-c(rep(1000, 10))
P_C.D2000$Level<-c(rep(2000, 10))
P_C.D10000$Level<-c(rep(10000, 10))
P_G.D500$Level<-c(rep(500, 10))
P_G.D1000$Level<-c(rep(1000, 10))
P_G.D2000$Level<-c(rep(2000, 10))
P_G.D10000$Level<-c(rep(10000, 10))
P_E.D500$Level<-c(rep(500, 10))
P_E.D1000$Level<-c(rep(1000, 10))
P_E.D500<-ext.PERMANOVA(E.D500)
P_E.D1000<-ext.PERMANOVA(E.D1000)
P_E.D2000<-ext.PERMANOVA(E.D2000)
P_E.D10000<-ext.PERMANOVA(E.D10000)
P_E.D500$Level<-c(rep(500, 10))
P_E.D1000$Level<-c(rep(1000, 10))
P_E.D2000$Level<-c(rep(2000, 10))
P_E.D10000$Level<-c(rep(10000, 10))
P_V.D500<-ext.PERMANOVA(V.D500)
P_V.D1000<-ext.PERMANOVA(V.D1000)
P_V.D2000<-ext.PERMANOVA(V.D2000)
P_V.D10000<-ext.PERMANOVA(V.D10000)
P_S.D500$Level<-c(rep(500, 10))
P_S.D1000$Level<-c(rep(1000, 10))
P_S.D500<-ext.PERMANOVA(S.D500)
P_S.D1000<-ext.PERMANOVA(S.D1000)
P_S.D2000<-ext.PERMANOVA(S.D2000)
P_S.D10000<-ext.PERMANOVA(S.D10000)
P_S.D500$Level<-c(rep(500, 10))
P_S.D1000$Level<-c(rep(1000, 10))
P_S.D2000$Level<-c(rep(2000, 10))
P_S.D10000$Level<-c(rep(10000, 10))
P_V.D500$Level<-c(rep(500, 10))
P_V.D1000$Level<-c(rep(1000, 10))
P_V.D2000$Level<-c(rep(2000, 10))
P_V.D10000$Level<-c(rep(10000, 10))
P_C.D500$rep<-c(1:10)
P_C.D1000$rep<-c(11:20)
P_C.D2000$rep<-c(21:30)
P_C.D10000$rep<-c(31:40)
P_G.D500$rep<-c(51:60)
P_G.D1000$rep<-c(61:70)
P_G.D2000$rep<-c(71:80)
P_G.D10000$rep<-c(81:90)
P_E.D500$rep<-c(91:100)
P_E.D1000$rep<-c(101:110)
P_E.D2000$rep<-c(111:120)
P_E.D10000$rep<-c(121:130)
P_S.D500$rep<-c(131:140)
P_S.D1000$rep<-c(141:150)
P_S.D2000$rep<-c(151:160)
P_S.D10000$rep<-c(161:170)
P_V.D500$rep<-c(171:180)
P_V.D1000$rep<-c(181:190)
P_V.D2000$rep<-c(191:200)
P_V.D10000$rep<-c(201:210)
Permanova.C<-do.call("rbind", list(P_C.D500,P_C.D1000,P_C.D2000,P_C.D10000))
Permanova.C2<-melt(data=Permanova.C, id.vars="Level", measure.vars = c("raw", "RA", "scaled", "eRare", "pRare", "limmaVST", "deseqVST", "deseqVST_scaled"))
Permanova.C3<-data_summary2(Permanova.C2, varname="value", groupnames=c("Level", "variable"))
Permanova.C2<-data_summary(Permanova.C2, varname="value", groupnames=c("Level", "variable"))
ggplot(Permanova.C2, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Mean +/- se)")+
theme_classic()
ggplot(Permanova.C3, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=low, ymax=high), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Median +/- min/max)")+
theme_classic()
Permanova.G<-do.call("rbind", list(P_G.D500,P_G.D1000,P_G.D2000,P_G.D10000))
Permanova.G2<-melt(data=Permanova.G, id.vars="Level", measure.vars = c("raw","RA", "scaled", "eRare", "pRare", "limmaVST", "deseqVST", "deseqVST_scaled"))
Permanova.G3<-data_summary2(Permanova.G2, varname="value", groupnames=c("Level", "variable"))
Permanova.G2<-data_summary(Permanova.G2, varname="value", groupnames=c("Level", "variable"))
ggplot(Permanova.G2, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Mean +/- se)")+
theme_classic()
ggplot(Permanova.G3, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=low, ymax=high), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Median +/- min/max)")+
theme_classic()
Permanova.E<-do.call("rbind", list(P_E.D500,P_E.D1000,P_E.D2000,P_E.D10000))
Permanova.E2<-melt(data=Permanova.E, id.vars="Level", measure.vars = c("raw","RA", "scaled", "eRare", "pRare", "limmaVST", "deseqVST", "deseqVST_scaled"))
Permanova.E3<-data_summary2(Permanova.E2, varname="value", groupnames=c("Level", "variable"))
Permanova.E2<-data_summary(Permanova.E2, varname="value", groupnames=c("Level", "variable"))
ggplot(Permanova.E2, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Mean +/- se)")+
theme_classic()
ggplot(Permanova.E3, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=low, ymax=high), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Median +/- min/max)")+
theme_classic()
Permanova.S<-do.call("rbind", list(P_S.D500,P_S.D1000,P_S.D2000,P_S.D10000))
Permanova.S2<-melt(data=Permanova.S, id.vars="Level", measure.vars = c("raw","RA", "scaled", "eRare", "pRare", "limmaVST", "deseqVST", "deseqVST_scaled"))
Permanova.S3<-data_summary2(Permanova.S2, varname="value", groupnames=c("Level", "variable"))
Permanova.S2<-data_summary(Permanova.S2, varname="value", groupnames=c("Level", "variable"))
ggplot(Permanova.S2, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Mean +/- se)")+
theme_classic()
ggplot(Permanova.S3, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=low, ymax=high), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Median +/- min/max)")+
theme_classic()
Permanova.V<-do.call("rbind", list(P_V.D500,P_V.D1000,P_V.D2000,P_V.D10000))
Permanova.V2<-melt(data=Permanova.V, id.vars="Level", measure.vars = c("raw","RA", "scaled", "eRare", "pRare", "limmaVST", "deseqVST", "deseqVST_scaled"))
Permanova.V3<-data_summary2(Permanova.V2, varname="value", groupnames=c("Level", "variable"))
Permanova.V2<-data_summary(Permanova.V2, varname="value", groupnames=c("Level", "variable"))
ggplot(Permanova.V2, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Mean +/- se)")+
theme_classic()
ggplot(Permanova.V3, aes(x=Level, y=value, group = variable, color=variable))+
geom_errorbar(aes(ymin=low, ymax=high), width=.1, position=position_dodge(300)) +
geom_line(position=position_dodge(300))+
geom_point(position=position_dodge(300))+
xlab("Seq. Depth")+
ylab("PERMANOVA R.sq. Index Value (Median +/- min/max)")+
theme_classic()
C.D1000$rep1$raw$PERMANOVA
ext.PERMANOVA2<-function(tst){
out<-list("raw"=c(rep(NA, length(tst))),"RA"=c(rep(NA, length(tst))), "scaled"=c(rep(NA, length(tst))), "pRare"=c(rep(NA, length(tst))), "eRare"=c(rep(NA, length(tst))), "deseqVST"=c(rep(NA, length(tst))),"deseqVST_scaled"=c(rep(NA, length(tst))), "limmaVST"=c(rep(NA, length(tst))))
for(i in 1:length(tst)) {out$raw[i]<-sum(tst[[i]]$raw$PERMANOVA$aov.tab$R2[2:6])}
for(i in 1:length(tst)) {out$RA[i]<-sum(tst[[i]]$RA$PERMANOVA$aov.tab$R2[2:6])}
for(i in 1:length(tst)) {out$scaled[i]<-sum(tst[[i]]$scaled$PERMANOVA$aov.tab$R2[2:6])}
for(i in 1:length(tst)) {out$pRare[i]<-sum(tst[[i]]$pRare$PERMANOVA$aov.tab$R2[2:6])}
for(i in 1:length(tst)) {out$eRare[i]<-sum(tst[[i]]$eRare$PERMANOVA$aov.tab$R2[2:6])}
for(i in 1:length(tst)) {out$deseqVST[i]<-sum(tst[[i]]$deseqVST$PERMANOVA$aov.tab$R2[2:6])}
for(i in 1:length(tst)) {out$deseqVST_scaled[i]<-sum(tst[[i]]$deseqVST_scaled$PERMANOVA$aov.tab$R2[2:6])}
for(i in 1:length(tst)) {out$limmaVST[i]<-sum(tst[[i]]$limma$PERMANOVA$aov.tab$R2[2:6])}
out1<-as.data.frame(out)
out1
#out2<-boxplot(out1)
#out4<-c("table"=out1,"plot"=out2)
#out4
}
# benchmark with total = 75; different sequencing depth
P_C.D500<-ext.PERMANOVA2(C.D500)
P_C.D500
plot(P_C.D500)
plot(P_C.D10000)
library(dada2)
install.packages("dada2")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("dada2", version = "3.10")
View(P_G.D500)
View(P_S.D1000)
View(P_S.D1000)
View(P_G.D2000)
View(P_S.D2000)
View(P_S.D2000)
View(P_S.D1000)
View(P_G.D500)
library(dada2)
View(P_E.D2000)
View(P_G.D500)
library(dada2)
install.package("RcppParallel")
install.packages("RcppParallel")
View(P_E.D500)
library("devtools")
devtools::install_github("benjjneb/dada2", ref="v3.1")
devtools::install_github("benjjneb/dada2")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ShortRead", version = "3.10")
