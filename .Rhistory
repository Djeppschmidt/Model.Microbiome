ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledOI-deseqOI,y=scaledLII-deseqLII, col=prevalence))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$raw$OI$R$lm
C.D500$rep1$raw$LII$R
lm(C.D500$rep1$raw$LII$R~C.D500$rep1$raw$OI$R$lm)
summary(lm(C.D500$rep1$raw$LII$R~C.D500$rep1$raw$OI$R$lm))
plot(C.D500$rep1$raw$LII$R, C.D500$rep1$raw$OI$R$lm)
plot(C.D500$rep1$scaled$LII$R, C.D500$rep1$scaled$OI$R$lm)
summary(lm(C.D500$rep1$scaled$LII$R~C.D500$rep1$scaled$OI$R$lm))
summary(lm(C.D500$rep1$deseqVST$LII$R~C.D500$rep1$deseqVST$OI$R$lm))
plot(C.D500$rep1$deseqVST$LII$R, C.D500$rep1$deseqVST$OI$R$lm)
C.D500$rep1$deseqVST$LII$R[C.D500$rep1$deseqVST$LII$R<3]
C.D500$rep1$deseqVST$OI$R$lm[C.D500$rep1$deseqVST$OI$R$lm>0.8]
C.D500$rep1$deseqVST$OI$R$lm[C.D500$rep1$deseqVST$OI$R$lm>0.9]
C.D500$rep1$deseqVST$OI$R$lm[C.D500$rep1$deseqVST$OI$R$lm>0.85]
C.D500$rep1$deseqVST$OI$R$lm[C.D500$rep1$deseqVST$OI$R$lm>0.8]
C.D500$rep1$deseqVST$LII$R[C.D500$rep1$deseqVST$LII$R<0.3]
names(C.D500$rep1$deseqVST$LII$R)
names(C.D500$rep1$deseqVST$OI$R$lm>)
names(C.D500$rep1$deseqVST$OI$R$lm)
plot(C.D500$rep1$deseqVST$OI$R$lm[names(C.D500$rep1$deseqVST$OI$R$lm) %in% c("spp221", "spp306", "spp315", "spp349", "370", "spp424")], C.D500$rep1$deseqVST$LII$R[names(C.D500$rep1$deseqVST$LII$R) %in% c("spp221", "spp306", "spp315", "spp349", "370", "spp424")])
plot(C.D500$rep1$scaled$OI$R$lm[names(C.D500$rep1$scaled$OI$R$lm) %in% c("spp221", "spp306", "spp315", "spp349", "370", "spp424")], C.D500$rep1$scaled$LII$R[names(C.D500$rep1$scaled$LII$R) %in% c("spp221", "spp306", "spp315", "spp349", "370", "spp424")])
plot(C.D500$rep1$scaled$OI$R$lm, C.D500$rep1$scaled$LII$R)
length(C.D500$rep1$scaled$OI$R$lm)
length(C.D500$rep1$scaled$LII$R)
identical(names(C.D500$rep1$scaled$LII$R), names(C.D500$rep1$scaled$OI$R$lm))
C.D500$rep1$scaled$LII$R[C.D500$rep1$scaled$LII$R>0.9]
C.D500$rep1$scaled$OI$R$lm[names(C.D500$rep1$scaled$OI$R$lm)%in% c("156","258","329","344","349","350","367","370","392")]
C.D500$rep1$scaled$OI$R$lm[names(C.D500$rep1$scaled$OI$R$lm) %in% c("spp156","spp258","spp329","spp344","spp349","spp350","spp367","spp370","spp392")]
View(as.matrix(otu_table(C.D500$rep1$scaled$comm)))
View(as.data.frame(as.matrix(otu_table(C.D500$rep1$scaled$comm))))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=scaledDMI-deseqDMI))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=prevalence,y=scaledDMI,col=deseqDMI))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledDMI-deseqDMI,y=scaledLII-deseqLII, col=prevalence))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=prevalence))+geom_point()+scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(mean_abundance*100)))+geom_point()+scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=scaledDMI))+
geom_point()+
scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=deseqDMI))+
geom_point()+
scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(mean_abundance)))+
geom_point()+
scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=prevalence))+
geom_point()+
scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=eRareDMI,col=eRareDMI))+
geom_point()+
scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=eRareLII,y=eRareDMI,col=log(mean_abundance)))+
geom_point()+
scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=scaledDMI-deseqDMI))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=deseqDMI))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=deseqDMI))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=deseqDMI))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=scaledDMI/scaledLIII))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=scaledDMI/scaledLII))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=scaledDMI/scaledLII))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=deseqDMI))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=deseqDMI/deseqLII))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=scaledDMI-scaledLII))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=scaledDMI-scaledLII))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=scaledLII-scaledDMI))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$model$SpeciesMeta
s<-rnorm(30, 3000, 500)
s
s<-round(s)
s
test<-transform_sample_counts(C.D500$rep1$model$comm, function(x) (x/sum(x))*s[x])
warnings()
test
View(as.data.table(as.matrix(otu_table(test))))
View(as.data.frame(as.matrix(otu_table(test))))
s2<-as.data.table(as.matrix(otu_table(C.D500$rep1$model$comm)))
s2<-as.data.frame(as.matrix(otu_table(C.D500$rep1$model$comm)))
s2
s[1]
s[2]
for (i in 1:ncol(s2)) {s2[i,]*s[i]}
s2
for (i in 1:ncol(s2)) {s2[i,]<-s2[i,]*s[i]}
s2
s2[1,]
s2[1,]*s[1]
for (i in 1:ncol(s2)) {s2[,i]*s[i]}
s2<-as.data.frame(as.matrix(otu_table(C.D500$rep1$model$comm)))
s2
for (i in 1:ncol(s2)) {s2[,i]*s[i]}
s2
s2[,i]*s[i]
s2<-as.data.frame(as.matrix(otu_table(C.D500$rep1$model$comm)))
for (i in 1:ncol(s2)) {s2[,i]<-s2[,i]*s[i]}
s2
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
C.D500$rep1$model$SpeciesMeta$M.Eval
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=M.Eval))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
?rbinom
?pbinom
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
summary(lm(output$model$SpeciesMeta$rawDMI~output$model$SpeciesMeta$rawLII))
summary(lm(C.D500$model$SpeciesMeta$rawDMI~C.D500$model$SpeciesMeta$rawLII))
summary(lm(C.D500$rep1$model$SpeciesMeta$rawDMI~C.D500$rep1$model$SpeciesMeta$rawLII))
test<-summary(lm(C.D500$rep1$model$SpeciesMeta$rawDMI~C.D500$rep1$model$SpeciesMeta$rawLII))
test$adj.r.squared
document()
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
C.D500$rep1$model$SpeciesMeta$scaleVA
C.D500$rep1$model$SpeciesMeta$deseqVA
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$model$stats
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=limmaLII,y=limmaDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
gplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=limmaLII,y=limmaDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
# benchmark with total = 75; different sequencing depth
P_C.D500<-ext.PERMANOVA(C.D500)
P_C.D500
box.LII<-data.frame("deseqVST"=C.D500$rep1$deseqVST$LII$R,"limmaVST"=C.D500$rep1$limma$LII$R,"RA"=C.D500$rep1$RA$LII$R,"erare"=C.D500$rep1$eRare$LII$R,"scaled"=C.D500$rep1$scaled$LII$R)
box.LII$names<-c(1:length(box.LII$RA))
#box.LII$names<-rownames(box.df)
m.boxLII<-melt(data=box.LII, id.vars="names", measure.vars = c("RA", "scaled", "erare", "limmaVST", "deseqVST"))
ggplot(m.boxLII, aes(x=variable, y=value))+
geom_violin() +
#geom_boxplot()+
geom_jitter()+
theme_classic()
box.df<-data.frame("reference"=C.D500$rep1$model$R$lm,"deseqVST"=C.D500$rep1$deseqVST$DMI$R$lm,"limmaVST"=C.D500$rep1$limma$DMI$R$lm,"RA"=C.D500$rep1$RA$DMI$R$lm,"erare"=C.D500$rep1$eRare$DMI$R$lm,"scaled"=C.D500$rep1$scaled$DMI$R$lm)
box.df<-data.frame("reference"=C.D500$rep1$model$R$lm,"deseqVST"=C.D500$rep1$deseqVST$DMI$R$lm,"limmaVST"=C.D500$rep1$limma$DMI$R$lm,"RA"=C.D500$rep1$RA$DMI$R$lm,"erare"=C.D500$rep1$eRare$DMI$R$lm,"scaled"=C.D500$rep1$scaled$DMI$R$lm)
C.D500$rep1$model$R$lm
C.D500$rep1$deseqVST$DMI$R$lm
box.df<-data.frame("reference"=C.D500$rep1$model$lm,"deseqVST"=C.D500$rep1$deseqVST$DMI$lm,"limmaVST"=C.D500$rep1$limma$DMI$lm,"RA"=C.D500$rep1$RA$DMI$lm,"erare"=C.D500$rep1$eRare$DMI$lm,"scaled"=C.D500$rep1$scaled$DMI$lm)
C.D500$rep1$deseqVST$DMI$lm
C.D500$rep1$limma$DMI$lm
C.D500$rep1$RA$DMI$lm
C.D500$rep1$eRare$DMI$lm
C.D500$rep1$scaled$DMI$lm
C.D500$rep1$model$lm
box.df<-data.frame("reference"=C.D500$rep1$model$R$lm,"deseqVST"=C.D500$rep1$deseqVST$DMI$lm,"limmaVST"=C.D500$rep1$limma$DMI$lm,"RA"=C.D500$rep1$RA$DMI$lm,"erare"=C.D500$rep1$eRare$DMI$lm,"scaled"=C.D500$rep1$scaled$DMI$lm)
box.df<-data.frame("reference"=C.D500$rep1$model$R$lm,"deseqVST"=C.D500$rep1$deseqVST$DMI$lm,"limmaVST"=C.D500$rep1$limma$DMI$lm,"RA"=C.D500$rep1$RA$DMI$lm,"erare"=C.D500$rep1$eRare$DMI$lm,"scaled"=C.D500$rep1$scaled$DMI$lm)
box.df$names<-rownames(box.df)
m.box<-melt(data=box.df, id.vars="names", measure.vars = c("reference", "RA", "scaled", "erare", "limmaVST", "deseqVST"))
box.df2<-data.frame("reference"=C.D500$rep1$model$R$lm[names(C.D500$rep1$model$R$lm)%in%keep],"deseqVST"=C.D500$rep1$deseqVST$DMI$R$lm[names(C.D500$rep1$deseqVST$DMI$R$lm)%in%keep],"limmaVST"=C.D500$rep1$limma$DMI$R$lm[names(C.D500$rep1$limma$DMI$R$lm)%in%keep],"RA"=C.D500$rep1$RA$DMI$R$lm[names(C.D500$rep1$RA$DMI$R$lm)%in%keep],"erare"=C.D500$rep1$eRare$DMI$R$lm[names(C.D500$rep1$eRare$DMI$R$lm)%in%keep],"scaled"=C.D500$rep1$scaled$DMI$R$lm[names(C.D500$rep1$scaled$DMI$R$lm)%in%keep])
box.df$names<-rownames(box.df)
box.df2$names<-rownames(box.df2)
m.box<-melt(data=box.df, id.vars="names", measure.vars = c("reference", "RA", "scaled", "erare", "limmaVST", "deseqVST"))
m.box2<-melt(data=box.df2, id.vars="names", measure.vars = c("reference", "RA", "scaled", "erare", "limmaVST", "deseqVST"))
ggplot(m.box, aes(x=variable, y=value))+
geom_violin() +
#geom_boxplot()+
geom_jitter()+
theme_classic()
ggplot(m.box2, aes(x=variable, y=value))+
geom_violin() +
#geom_boxplot()+
geom_jitter()+
theme_classic()
ggplot(m.box, aes(x=variable, y=value))+
geom_violin() +
#geom_boxplot()+
geom_jitter()+
theme_classic()
box.LII<-data.frame("deseqVST"=C.D500$rep1$deseqVST$LII$R,"limmaVST"=C.D500$rep1$limma$LII$R,"RA"=C.D500$rep1$RA$LII$R,"erare"=C.D500$rep1$eRare$LII$R,"scaled"=C.D500$rep1$scaled$LII$R)
box.LII$names<-c(1:length(box.LII$RA))
#box.LII$names<-rownames(box.df)
m.boxLII<-melt(data=box.LII, id.vars="names", measure.vars = c("RA", "scaled", "erare", "limmaVST", "deseqVST"))
ggplot(m.boxLII, aes(x=variable, y=value))+
geom_violin() +
#geom_boxplot()+
geom_jitter()+
theme_classic()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
box.LII<-data.frame("deseqVST"=C.D500$rep1$deseqVST$LII$R,"limmaVST"=C.D500$rep1$limma$LII$R,"RA"=C.D500$rep1$RA$LII$R,"erare"=C.D500$rep1$eRare$LII$R,"scaled"=C.D500$rep1$scaled$LII$R)
box.LII$names<-c(1:length(box.LII$RA))
#box.LII$names<-rownames(box.df)
m.boxLII<-melt(data=box.LII, id.vars="names", measure.vars = c("RA", "scaled", "erare", "limmaVST", "deseqVST"))
ggplot(m.boxLII, aes(x=variable, y=value))+
geom_violin() +
#geom_boxplot()+
geom_jitter()+
theme_classic()
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=limmaLII,y=limmaDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$model$stats
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=limmaLII,y=limmaDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=eRareLII,y=eRareDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$raw$DMI$lm
document()
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
DMI
test<-DMI(C.D500$rep1$model$comm, C.D500$rep1$scaled$comm)
test<-lm.test(C.D500$rep1$scaled$comm)
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=limmaLII,y=limmaDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=eRareLII,y=eRareDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$model$stats
plot(C.D500$rep1$raw$DMI$SVI~C.D500$rep1$raw$LII$R)
plot(C.D500$rep1$raw$DMI$SVI~1-C.D500$rep1$raw$LII$R)
1-C.D500$rep1$raw$LII$R
C.D500$rep1$raw$LII$R
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=limmaLII,y=limmaDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=eRareLII,y=eRareDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$model$stats
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=limmaLII,y=limmaDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=eRareLII,y=eRareDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$model$SpeciesMeta$limmaDMI
SVI
?ggrare
install.packages("remotes")
remotes::install_github("gauravsk/ranacapa")
install.packages("remotes")
remotes::install_github("gauravsk/ranacapa")
remotes::install_github("gauravsk/ranacapa")
remotes::install_github("gauravsk/ranacapa")
library(ranacapa)
knitr::opts_chunk$set(echo = TRUE)
ggrare(C.D500$rep1$raw$comm, 50)
ggrare(C.D500$rep1$raw$comm, 50, color="Factor")
ggrare(C.D500$rep1$model$comm, 50, color="Factor")
ggrare(C.D500$rep1$raw$comm, 50, color="Factor")
ggrare(C.D500$rep1$model$comm, 50, color="Factor")
ggrare(C.D500$rep1$raw$comm, 50, color="Factor")
ggrare(C.D500$rep1$model$comm, 500, color="Factor")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
library(Model.Microbiome)
library(ggplot2)
library(ggplot2)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(Model.Microbiome)
library(ggplot2)
library(vegan)
library(dplyr)
library(plyr)
library(phyloseq)
library(viridis)
library(ranacapa)
ggrare(C.D500$rep1$raw$comm, 50, color="Factor")
ggrare(C.D500$rep1$model$comm, 500, color="Factor")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=scaledLII,y=scaledDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=deseqDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=rawLII,y=rawDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=RALII,y=RADMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=limmaLII,y=limmaDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=eRareLII,y=eRareDMI,col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqDMI,y=scaledDMI, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
ggplot(C.D500$rep1$model$SpeciesMeta, aes(x=deseqLII,y=scaledLII, col=log(M.Eval)))+geom_point()+ scale_color_viridis_c(option="C")
C.D500$rep1$model$stats
document()
library(devtools)
getwd()
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
test<-merge_phyloseq(C.D500$rep1$model$comm,C.D500$rep1$model$comm)
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
knitr::opts_chunk$set(echo = TRUE)
library(Model.Microbiome)
library(ggplot2)
library(vegan)
library(dplyr)
library(plyr)
library(phyloseq)
library(viridis)
library(ranacapa)
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
library(Model.Microbiome)
library(ggplot2)
library(vegan)
library(dplyr)
library(plyr)
library(phyloseq)
library(viridis)
library(ranacapa)
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
knitr::opts_chunk$set(echo = TRUE)
library(Model.Microbiome)
library(ggplot2)
library(vegan)
library(dplyr)
library(plyr)
library(phyloseq)
library(viridis)
library(ranacapa)
library(edgeR)
library(limma)
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
library(devtools)
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
document()
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
test<-model.rarefy(C.D500$rep1$model$comm, set.seqDepth(500,250), 500, 250)
test
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
# mostly universal taxa
# benchmark with total = 75; different sequencing depth (low sparsity)
#Test runs:
C.D500<-suppressWarnings(benchmark.MM(reps=1, commonN=73, groupN=1, singleN=1, D=500, V=250))
